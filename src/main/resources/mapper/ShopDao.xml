<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace 命名空间
     通常情况下，命名空间的值就是当前操作实体类的全名称
-->
<mapper namespace="com.imooc.o2o.dao.ShopDao">
  <insert id="insert" parameterType="Shop">
    insert into o2o.shop(priority, shop_img, name, description, contact_info, addr, area_id, shop_kind_id, person_info_id, status, create_time, last_edit_time, advice)
    value (#{priority}, #{shopImg}, #{name}, #{description}, #{contactInfo}, #{addr}, #{area.areaId}, #{shopKind.shopKindId}, #{personInfo.personId}, #{status}, #{createTime}, #{lastEditTime}, #{advice});
  </insert>

  <resultMap id="shopResultMap" type="Shop">
    <association property="area" column="area_id" javaType="Area"/>
    <association property="shopKind" column="shop_kind_id" javaType="ShopKind"/>
    <association property="personInfo" column="person_info_id" javaType="PersonInfo"/>
  </resultMap>

  <select id="queryShopByShopName" resultType="Shop" resultMap="shopResultMap">
    select *
    from shop as s
    where s.name = #{shopName}
    left outer join area as a on s.area_id = a.area_id
    left outer join shop_kind as sk on s.shop_kind_id = sk.shop_kind_id
    left outer join person_info as pi on s.person_info_id = pi.person_id;
  </select>
</mapper>